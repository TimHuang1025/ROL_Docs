<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-登录/security-encryption" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">安全加密详解 | 游戏项目文档</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://timhuang1025.github.io/ROL_Docs/docs/登录/security-encryption"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="安全加密详解 | 游戏项目文档"><meta data-rh="true" name="description" content="概述"><meta data-rh="true" property="og:description" content="概述"><link data-rh="true" rel="icon" href="/ROL_Docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://timhuang1025.github.io/ROL_Docs/docs/登录/security-encryption"><link data-rh="true" rel="alternate" href="https://timhuang1025.github.io/ROL_Docs/docs/登录/security-encryption" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://timhuang1025.github.io/ROL_Docs/docs/登录/security-encryption" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"安全加密详解","item":"https://timhuang1025.github.io/ROL_Docs/docs/登录/security-encryption"}]}</script><link rel="stylesheet" href="/ROL_Docs/assets/css/styles.014bc8ab.css">
<script src="/ROL_Docs/assets/js/runtime~main.43072571.js" defer="defer"></script>
<script src="/ROL_Docs/assets/js/main.5f1e566d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ROL_Docs/"><b class="navbar__title text--truncate">游戏文档</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ROL_Docs/docs/intro">API文档</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">系统文档</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ROL_Docs/docs/卡牌">卡片系统</a></li><li><a class="dropdown__link" href="/ROL_Docs/docs/工会">工会系统</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/TimHuang1025/ROL_Docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ROL_Docs/docs/intro">游戏概述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ROL_Docs/docs/卡牌/card-overview">卡牌</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/ROL_Docs/docs/工会/union-create">工会</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/ROL_Docs/docs/登录/login-overview">登录</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/login-overview">登录系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/account-login">账号密码登录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/register-system">注册系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/visitor-login">游客登录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/third-party-login">第三方登录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/email-verification">邮箱验证系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/player-data">玩家数据管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ROL_Docs/docs/登录/security-encryption">安全加密详解</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/network-communication">网络通信机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/error-handling">错误处理系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ROL_Docs/docs/登录/ui-implementation">UI实现细节</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/ROL_Docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">登录</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">安全加密详解</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>安全加密详解</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="概述">概述<a href="#概述" class="hash-link" aria-label="概述的直接链接" title="概述的直接链接">​</a></h2>
<p>游戏登录系统采用多层加密机制保护用户密码安全，包括SHA256哈希、AES对称加密和RSA非对称加密。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="加密方案对比">加密方案对比<a href="#加密方案对比" class="hash-link" aria-label="加密方案对比的直接链接" title="加密方案对比的直接链接">​</a></h2>
<table><thead><tr><th>登录方式</th><th>加密方案</th><th>安全等级</th><th>说明</th></tr></thead><tbody><tr><td><strong>账号登录</strong></td><td>双重SHA256</td><td>⭐⭐⭐</td><td>SHA256 + 时间戳</td></tr><tr><td><strong>账号注册</strong></td><td>三层加密</td><td>⭐⭐⭐⭐⭐</td><td>SHA256 + AES + RSA</td></tr><tr><td><strong>游客登录</strong></td><td>无加密</td><td>⭐</td><td>仅设备ID</td></tr><tr><td><strong>第三方登录</strong></td><td>OAuth Token</td><td>⭐⭐⭐⭐</td><td>由第三方保证安全</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sha256哈希加密">SHA256哈希加密<a href="#sha256哈希加密" class="hash-link" aria-label="SHA256哈希加密的直接链接" title="SHA256哈希加密的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现代码">实现代码<a href="#实现代码" class="hash-link" aria-label="实现代码的直接链接" title="实现代码的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">AuthAPI.cs - SHA256实现</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static string Sha256Hex(string raw)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using var sha = SHA256.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] hash = sha.ComputeHash(Encoding.UTF8.GetBytes(raw));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return BitConverter.ToString(hash).Replace(&quot;-&quot;, &quot;&quot;).ToLower();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="特点">特点<a href="#特点" class="hash-link" aria-label="特点的直接链接" title="特点的直接链接">​</a></h3>
<ul>
<li><strong>不可逆性</strong>: 无法从哈希值还原原文</li>
<li><strong>固定长度</strong>: 输出始终为256位（64个十六进制字符）</li>
<li><strong>雪崩效应</strong>: 输入微小变化导致输出完全不同</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="登录时的双重sha256">登录时的双重SHA256<a href="#登录时的双重sha256" class="hash-link" aria-label="登录时的双重SHA256的直接链接" title="登录时的双重SHA256的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">密码登录加密流程</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public Coroutine PasswordLogin(string account, string rawPwd,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               Action&lt;string&gt; ok, Action&lt;string&gt; fail)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long ts = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string tsStr = ts.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第一次SHA256：原始密码哈希</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string sha1 = Sha256Hex(rawPwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第二次SHA256：加入时间戳</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string sha2 = Sha256Hex(sha1 + tsStr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string url = $&quot;{host}/user/PasswordLogin&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string body = $&quot;{{\&quot;username\&quot;:\&quot;{account}\&quot;,&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  $&quot;\&quot;password\&quot;:\&quot;{sha2}\&quot;,&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  $&quot;\&quot;timestamp\&quot;:\&quot;{tsStr}\&quot;}}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return StartCoroutine(PostJson(url, body, ok, fail));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>为什么要两次SHA256？</strong></p>
<ol>
<li>第一次：确保密码不可逆</li>
<li>第二次+时间戳：防止重放攻击</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="aes对称加密">AES对称加密<a href="#aes对称加密" class="hash-link" aria-label="AES对称加密的直接链接" title="AES对称加密的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现代码-1">实现代码<a href="#实现代码-1" class="hash-link" aria-label="实现代码的直接链接" title="实现代码的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">AuthAPI.cs - AES加密实现</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static string AesEncrypt(string plainHex, long tsMillis)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 固定密钥（16字节）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] key = Encoding.ASCII.GetBytes(AES_KEY);  // &quot;ROLTKROLTKROLTK1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 使用时间戳生成IV（16字节）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] iv = Encoding.ASCII.GetBytes(tsMillis.ToString() + &quot;000&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using var aes = Aes.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aes.Key = key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aes.IV = iv;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aes.Mode = CipherMode.CBC;      // CBC模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aes.Padding = PaddingMode.PKCS7; // PKCS7填充</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using var enc = aes.CreateEncryptor();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] bytes = Encoding.UTF8.GetBytes(plainHex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] cipher = enc.TransformFinalBlock(bytes, 0, bytes.Length);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Convert.ToBase64String(cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aes参数说明">AES参数说明<a href="#aes参数说明" class="hash-link" aria-label="AES参数说明的直接链接" title="AES参数说明的直接链接">​</a></h3>
<table><thead><tr><th>参数</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td><strong>密钥</strong></td><td><code>ROLTKROLTKROLTK1</code></td><td>16字节固定密钥</td></tr><tr><td><strong>IV向量</strong></td><td>时间戳+&quot;000&quot;</td><td>16字节初始化向量</td></tr><tr><td><strong>模式</strong></td><td>CBC</td><td>密码块链接模式</td></tr><tr><td><strong>填充</strong></td><td>PKCS7</td><td>标准填充方式</td></tr><tr><td><strong>输出</strong></td><td>Base64</td><td>便于传输</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cbc模式特点">CBC模式特点<a href="#cbc模式特点" class="hash-link" aria-label="CBC模式特点的直接链接" title="CBC模式特点的直接链接">​</a></h3>
<ul>
<li>每个明文块与前一个密文块异或后加密</li>
<li>需要初始化向量（IV）</li>
<li>相同明文不会产生相同密文</li>
<li>适合加密长数据</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rsa非对称加密">RSA非对称加密<a href="#rsa非对称加密" class="hash-link" aria-label="RSA非对称加密的直接链接" title="RSA非对称加密的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rsa公钥配置">RSA公钥配置<a href="#rsa公钥配置" class="hash-link" aria-label="RSA公钥配置的直接链接" title="RSA公钥配置的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">AuthAPI.cs - RSA公钥</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// RSA公钥（PEM格式，用于备份）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string RSA_PUB_PEM =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@&quot;-----BEGIN PUBLIC KEY-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApPOsZmpEoCDxSOiIcoB5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JckxzUh4O/0jJEUt+pIDZSJHfryKvchnlYMO/Kgx5Mb2D55MYnuHKy4StJ6gwxVm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gh92k6P8IiqQuXeptSK+Ze3kmziPHX7g9ycoBTBo73thzIufmWd12W+sG6SZkpyb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kIhRfDN7bJGxc0nApWqNzC14octYSnrqcRWGwj4kMeGkK9ELwye5gxl45iND+cD4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IWjkCgDwhKq9o0PZWYk2hkAMLwbxpKVaaU/rIcW5QxUisOUuWxxtt6m0ua5+AgQR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">we5P5ZPHZXCA54OEslgQgxi+VLN8C1cZXvXIjHJNC8jy2EMsuDpxqn02IaJ86t3P</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mwIDAQAB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END PUBLIC KEY-----&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 分解后的模数和指数（实际使用）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string RSA_MOD_B64 = &quot;pPOsZmpEoCDxSOiIcoB5...&quot;;  // 2048位模数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string RSA_EXP_B64 = &quot;AQAB&quot;;                      // 65537</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rsa加密实现">RSA加密实现<a href="#rsa加密实现" class="hash-link" aria-label="RSA加密实现的直接链接" title="RSA加密实现的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">AuthAPI.cs - RSA加密</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">static string RsaEncryptBase64(string base64Plain)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] plainBytes = Convert.FromBase64String(base64Plain);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using var rsa = RSA.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rsa.ImportParameters(new RSAParameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Modulus = Convert.FromBase64String(RSA_MOD_B64),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exponent = Convert.FromBase64String(RSA_EXP_B64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 使用PKCS1填充</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] cipher = rsa.Encrypt(plainBytes, RSAEncryptionPadding.Pkcs1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Convert.ToBase64String(cipher);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rsa特点">RSA特点<a href="#rsa特点" class="hash-link" aria-label="RSA特点的直接链接" title="RSA特点的直接链接">​</a></h3>
<ul>
<li><strong>密钥长度</strong>: 2048位</li>
<li><strong>填充方式</strong>: PKCS#1 v1.5</li>
<li><strong>公钥加密</strong>: 任何人都可以加密</li>
<li><strong>私钥解密</strong>: 只有服务器能解密</li>
<li><strong>速度较慢</strong>: 只用于加密小数据</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三层加密流程注册">三层加密流程（注册）<a href="#三层加密流程注册" class="hash-link" aria-label="三层加密流程（注册）的直接链接" title="三层加密流程（注册）的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="完整实现">完整实现<a href="#完整实现" class="hash-link" aria-label="完整实现的直接链接" title="完整实现的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_OeMC">AccountRegister - 三层加密</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public Coroutine AccountRegister(string account, string rawPwd,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 Action&lt;string&gt; ok, Action&lt;string&gt; fail)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long ts = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string tsStr = ts.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第一层：SHA256哈希</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string pwd1 = Sha256Hex(rawPwd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第二层：AES-CBC加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string pwd2 = AesEncrypt(pwd1, ts);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 第三层：RSA公钥加密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string pwd3 = RsaEncryptBase64(pwd2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string url = $&quot;{host}/user/Register&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string body = $&quot;{{\&quot;username\&quot;:\&quot;{account}\&quot;,&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  $&quot;\&quot;password\&quot;:\&quot;{pwd3}\&quot;,&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  $&quot;\&quot;timestamp\&quot;:\&quot;{tsStr}\&quot;}}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Debug.Log(&quot;Body = &quot; + body);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return StartCoroutine(PostJson(url, body, ok, fail));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="加密流程图">加密流程图<a href="#加密流程图" class="hash-link" aria-label="加密流程图的直接链接" title="加密流程图的直接链接">​</a></h3>
<div class="language-mermaid codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-mermaid codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">graph TD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    A[原始密码: password123] --&gt; B[SHA256哈希]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B --&gt; C[pwd1: 482c811da5d5b4bc...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C --&gt; D[AES-CBC加密]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    D --&gt; E[pwd2: U2FsdGVkX1+...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    E --&gt; F[RSA公钥加密]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F --&gt; G[pwd3: MIIBCgKCAQEA...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    G --&gt; H[发送到服务器]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="各层作用">各层作用<a href="#各层作用" class="hash-link" aria-label="各层作用的直接链接" title="各层作用的直接链接">​</a></h3>
<table><thead><tr><th>层级</th><th>算法</th><th>目的</th><th>输出格式</th></tr></thead><tbody><tr><td><strong>第一层</strong></td><td>SHA256</td><td>不可逆，防止明文泄露</td><td>十六进制字符串</td></tr><tr><td><strong>第二层</strong></td><td>AES-CBC</td><td>对称加密，高效安全</td><td>Base64字符串</td></tr><tr><td><strong>第三层</strong></td><td>RSA-PKCS1</td><td>非对称加密，防中间人</td><td>Base64字符串</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="时间戳机制">时间戳机制<a href="#时间戳机制" class="hash-link" aria-label="时间戳机制的直接链接" title="时间戳机制的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="作用">作用<a href="#作用" class="hash-link" aria-label="作用的直接链接" title="作用的直接链接">​</a></h3>
<ol>
<li><strong>防重放攻击</strong>: 相同请求不能重复使用</li>
<li><strong>生成唯一IV</strong>: AES加密需要随机IV</li>
<li><strong>请求时效性</strong>: 服务器可验证请求新鲜度</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用方式">使用方式<a href="#使用方式" class="hash-link" aria-label="使用方式的直接链接" title="使用方式的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 生成毫秒级时间戳</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long ts = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 用于SHA256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string sha2 = Sha256Hex(sha1 + ts.ToString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 用于AES的IV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] iv = Encoding.ASCII.GetBytes(ts.ToString() + &quot;000&quot;);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安全性分析">安全性分析<a href="#安全性分析" class="hash-link" aria-label="安全性分析的直接链接" title="安全性分析的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="攻击防护">攻击防护<a href="#攻击防护" class="hash-link" aria-label="攻击防护的直接链接" title="攻击防护的直接链接">​</a></h3>
<table><thead><tr><th>攻击类型</th><th>防护措施</th><th>效果</th></tr></thead><tbody><tr><td><strong>暴力破解</strong></td><td>SHA256哈希</td><td>计算成本极高</td></tr><tr><td><strong>重放攻击</strong></td><td>时间戳验证</td><td>请求不可重用</td></tr><tr><td><strong>中间人攻击</strong></td><td>RSA加密</td><td>无私钥无法解密</td></tr><tr><td><strong>彩虹表攻击</strong></td><td>加盐（时间戳）</td><td>预计算表失效</td></tr><tr><td><strong>密文分析</strong></td><td>AES-CBC模式</td><td>相同明文不同密文</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安全建议">安全建议<a href="#安全建议" class="hash-link" aria-label="安全建议的直接链接" title="安全建议的直接链接">​</a></h3>
<ol>
<li>
<p><strong>密钥管理</strong></p>
<ul>
<li>AES密钥不应硬编码</li>
<li>RSA私钥必须安全存储</li>
<li>定期更换密钥</li>
</ul>
</li>
<li>
<p><strong>传输安全</strong></p>
<ul>
<li>生产环境使用HTTPS</li>
<li>考虑证书固定</li>
</ul>
</li>
<li>
<p><strong>客户端安全</strong></p>
<ul>
<li>代码混淆</li>
<li>防调试保护</li>
<li>关键逻辑服务器验证</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="密钥和常量">密钥和常量<a href="#密钥和常量" class="hash-link" aria-label="密钥和常量的直接链接" title="密钥和常量的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="当前配置">当前配置<a href="#当前配置" class="hash-link" aria-label="当前配置的直接链接" title="当前配置的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 服务器地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string host = &quot;http://login.threekingdom.realmoflegend.com:8000&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// AES密钥（16字节）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string AES_KEY = &quot;ROLTKROLTKROLTK1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// RSA公钥指数（65537）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const string RSA_EXP_B64 = &quot;AQAB&quot;;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注意事项">注意事项<a href="#注意事项" class="hash-link" aria-label="注意事项的直接链接" title="注意事项的直接链接">​</a></h3>
<ol>
<li>
<p><strong>AES密钥硬编码风险</strong></p>
<ul>
<li>当前密钥硬编码在客户端</li>
<li>建议使用密钥交换协议</li>
</ul>
</li>
<li>
<p><strong>HTTP传输风险</strong></p>
<ul>
<li>当前使用HTTP而非HTTPS</li>
<li>生产环境必须使用HTTPS</li>
</ul>
</li>
<li>
<p><strong>RSA密钥长度</strong></p>
<ul>
<li>2048位满足当前安全需求</li>
<li>未来可考虑升级到4096位</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="性能考虑">性能考虑<a href="#性能考虑" class="hash-link" aria-label="性能考虑的直接链接" title="性能考虑的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="算法性能对比">算法性能对比<a href="#算法性能对比" class="hash-link" aria-label="算法性能对比的直接链接" title="算法性能对比的直接链接">​</a></h3>
<table><thead><tr><th>算法</th><th>速度</th><th>CPU占用</th><th>适用场景</th></tr></thead><tbody><tr><td>SHA256</td><td>快</td><td>低</td><td>所有密码处理</td></tr><tr><td>AES</td><td>快</td><td>低</td><td>大量数据加密</td></tr><tr><td>RSA</td><td>慢</td><td>高</td><td>小数据/密钥交换</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="优化建议">优化建议<a href="#优化建议" class="hash-link" aria-label="优化建议的直接链接" title="优化建议的直接链接">​</a></h3>
<ol>
<li>
<p><strong>缓存优化</strong></p>
<ul>
<li>RSA参数可预先导入</li>
<li>AES密钥可复用</li>
</ul>
</li>
<li>
<p><strong>异步处理</strong></p>
<ul>
<li>加密操作异步执行</li>
<li>避免阻塞主线程</li>
</ul>
</li>
<li>
<p><strong>批量处理</strong></p>
<ul>
<li>多个请求合并加密</li>
<li>减少RSA调用次数</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="测试验证">测试验证<a href="#测试验证" class="hash-link" aria-label="测试验证的直接链接" title="测试验证的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="加密结果验证">加密结果验证<a href="#加密结果验证" class="hash-link" aria-label="加密结果验证的直接链接" title="加密结果验证的直接链接">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SHA256测试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string test = Sha256Hex(&quot;password&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 预期：5e884898da28047151d0e56f8dc62927...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// AES测试（结果随IV变化）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string aesResult = AesEncrypt(&quot;test&quot;, 1234567890000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Base64格式输出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// RSA测试（结果固定）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string rsaResult = RsaEncryptBase64(&quot;dGVzdA==&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Base64格式输出</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="常见问题的直接链接" title="常见问题的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q-为什么注册用三层加密登录只用两层">Q: 为什么注册用三层加密，登录只用两层？<a href="#q-为什么注册用三层加密登录只用两层" class="hash-link" aria-label="Q: 为什么注册用三层加密，登录只用两层？的直接链接" title="Q: 为什么注册用三层加密，登录只用两层？的直接链接">​</a></h3>
<p><strong>A:</strong> 注册时密码是第一次传输，需要最高安全性。登录时服务器已有密码哈希，风险相对较低。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q-aes的iv为什么用时间戳">Q: AES的IV为什么用时间戳？<a href="#q-aes的iv为什么用时间戳" class="hash-link" aria-label="Q: AES的IV为什么用时间戳？的直接链接" title="Q: AES的IV为什么用时间戳？的直接链接">​</a></h3>
<p><strong>A:</strong> 时间戳保证每次加密的IV都不同，避免相同密码产生相同密文。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q-rsa为什么用pkcs1而不是oaep">Q: RSA为什么用PKCS1而不是OAEP？<a href="#q-rsa为什么用pkcs1而不是oaep" class="hash-link" aria-label="Q: RSA为什么用PKCS1而不是OAEP？的直接链接" title="Q: RSA为什么用PKCS1而不是OAEP？的直接链接">​</a></h3>
<p><strong>A:</strong> 兼容性考虑，PKCS1 v1.5在各平台支持更好。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="q-客户端能看到rsa私钥吗">Q: 客户端能看到RSA私钥吗？<a href="#q-客户端能看到rsa私钥吗" class="hash-link" aria-label="Q: 客户端能看到RSA私钥吗？的直接链接" title="Q: 客户端能看到RSA私钥吗？的直接链接">​</a></h3>
<p><strong>A:</strong> 不能。客户端只有公钥，私钥在服务器端。</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/ROL_Docs/docs/登录/player-data"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">玩家数据管理</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ROL_Docs/docs/登录/network-communication"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">网络通信机制</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概述" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#加密方案对比" class="table-of-contents__link toc-highlight">加密方案对比</a></li><li><a href="#sha256哈希加密" class="table-of-contents__link toc-highlight">SHA256哈希加密</a><ul><li><a href="#实现代码" class="table-of-contents__link toc-highlight">实现代码</a></li><li><a href="#特点" class="table-of-contents__link toc-highlight">特点</a></li><li><a href="#登录时的双重sha256" class="table-of-contents__link toc-highlight">登录时的双重SHA256</a></li></ul></li><li><a href="#aes对称加密" class="table-of-contents__link toc-highlight">AES对称加密</a><ul><li><a href="#实现代码-1" class="table-of-contents__link toc-highlight">实现代码</a></li><li><a href="#aes参数说明" class="table-of-contents__link toc-highlight">AES参数说明</a></li><li><a href="#cbc模式特点" class="table-of-contents__link toc-highlight">CBC模式特点</a></li></ul></li><li><a href="#rsa非对称加密" class="table-of-contents__link toc-highlight">RSA非对称加密</a><ul><li><a href="#rsa公钥配置" class="table-of-contents__link toc-highlight">RSA公钥配置</a></li><li><a href="#rsa加密实现" class="table-of-contents__link toc-highlight">RSA加密实现</a></li><li><a href="#rsa特点" class="table-of-contents__link toc-highlight">RSA特点</a></li></ul></li><li><a href="#三层加密流程注册" class="table-of-contents__link toc-highlight">三层加密流程（注册）</a><ul><li><a href="#完整实现" class="table-of-contents__link toc-highlight">完整实现</a></li><li><a href="#加密流程图" class="table-of-contents__link toc-highlight">加密流程图</a></li><li><a href="#各层作用" class="table-of-contents__link toc-highlight">各层作用</a></li></ul></li><li><a href="#时间戳机制" class="table-of-contents__link toc-highlight">时间戳机制</a><ul><li><a href="#作用" class="table-of-contents__link toc-highlight">作用</a></li><li><a href="#使用方式" class="table-of-contents__link toc-highlight">使用方式</a></li></ul></li><li><a href="#安全性分析" class="table-of-contents__link toc-highlight">安全性分析</a><ul><li><a href="#攻击防护" class="table-of-contents__link toc-highlight">攻击防护</a></li><li><a href="#安全建议" class="table-of-contents__link toc-highlight">安全建议</a></li></ul></li><li><a href="#密钥和常量" class="table-of-contents__link toc-highlight">密钥和常量</a><ul><li><a href="#当前配置" class="table-of-contents__link toc-highlight">当前配置</a></li><li><a href="#注意事项" class="table-of-contents__link toc-highlight">注意事项</a></li></ul></li><li><a href="#性能考虑" class="table-of-contents__link toc-highlight">性能考虑</a><ul><li><a href="#算法性能对比" class="table-of-contents__link toc-highlight">算法性能对比</a></li><li><a href="#优化建议" class="table-of-contents__link toc-highlight">优化建议</a></li></ul></li><li><a href="#测试验证" class="table-of-contents__link toc-highlight">测试验证</a><ul><li><a href="#加密结果验证" class="table-of-contents__link toc-highlight">加密结果验证</a></li></ul></li><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a><ul><li><a href="#q-为什么注册用三层加密登录只用两层" class="table-of-contents__link toc-highlight">Q: 为什么注册用三层加密，登录只用两层？</a></li><li><a href="#q-aes的iv为什么用时间戳" class="table-of-contents__link toc-highlight">Q: AES的IV为什么用时间戳？</a></li><li><a href="#q-rsa为什么用pkcs1而不是oaep" class="table-of-contents__link toc-highlight">Q: RSA为什么用PKCS1而不是OAEP？</a></li><li><a href="#q-客户端能看到rsa私钥吗" class="table-of-contents__link toc-highlight">Q: 客户端能看到RSA私钥吗？</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 游戏项目文档</div></div></div></footer></div>
</body>
</html>