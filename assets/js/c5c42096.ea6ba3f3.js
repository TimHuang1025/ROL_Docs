"use strict";(self.webpackChunkgame_docs=self.webpackChunkgame_docs||[]).push([[373],{6183:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"\u767b\u5f55/error-handling","title":"\u9519\u8bef\u5904\u7406\u7cfb\u7edf","description":"\u6982\u8ff0","source":"@site/docs/\u767b\u5f55/error-handling.md","sourceDirName":"\u767b\u5f55","slug":"/\u767b\u5f55/error-handling","permalink":"/ROL_Docs/docs/\u767b\u5f55/error-handling","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"id":"error-handling","title":"\u9519\u8bef\u5904\u7406\u7cfb\u7edf","sidebar_label":"\u9519\u8bef\u5904\u7406\u7cfb\u7edf","sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"\u7f51\u7edc\u901a\u4fe1\u673a\u5236","permalink":"/ROL_Docs/docs/\u767b\u5f55/network-communication"},"next":{"title":"UI\u5b9e\u73b0\u7ec6\u8282","permalink":"/ROL_Docs/docs/\u767b\u5f55/ui-implementation"}}');var i=r(4848),t=r(8453);const a={id:"error-handling",title:"\u9519\u8bef\u5904\u7406\u7cfb\u7edf",sidebar_label:"\u9519\u8bef\u5904\u7406\u7cfb\u7edf",sidebar_position:10},s="\u9519\u8bef\u5904\u7406\u7cfb\u7edf",o={},d=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u9519\u8bef\u63d0\u793a\u5c42\u7ea7",id:"\u9519\u8bef\u63d0\u793a\u5c42\u7ea7",level:2},{value:"\u63d0\u793a\u7c7b\u578b\u5bf9\u6bd4",id:"\u63d0\u793a\u7c7b\u578b\u5bf9\u6bd4",level:3},{value:"\u5b57\u6bb5\u7ea7\u9519\u8bef\u63d0\u793a",id:"\u5b57\u6bb5\u7ea7\u9519\u8bef\u63d0\u793a",level:2},{value:"ShowFieldError\u5b9e\u73b0",id:"showfielderror\u5b9e\u73b0",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:3},{value:"UI\u7ed1\u5b9a",id:"ui\u7ed1\u5b9a",level:3},{value:"Toast\u8f7b\u91cf\u63d0\u793a",id:"toast\u8f7b\u91cf\u63d0\u793a",level:2},{value:"Toast\u5b9e\u73b0",id:"toast\u5b9e\u73b0",level:3},{value:"Toast\u6837\u5f0f",id:"toast\u6837\u5f0f",level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:3},{value:"PopupManager\u5168\u5c40\u5f39\u7a97",id:"popupmanager\u5168\u5c40\u5f39\u7a97",level:2},{value:"PopupManager\u5b9e\u73b0",id:"popupmanager\u5b9e\u73b0",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b-1",level:3},{value:"Loading\u72b6\u6001\u7ba1\u7406",id:"loading\u72b6\u6001\u7ba1\u7406",level:2},{value:"LoadingPanelManager",id:"loadingpanelmanager",level:3},{value:"SpinController",id:"spincontroller",level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f-1",level:3},{value:"\u9519\u8bef\u7801\u4f53\u7cfb",id:"\u9519\u8bef\u7801\u4f53\u7cfb",level:2},{value:"HTTP\u9519\u8bef\u7801",id:"http\u9519\u8bef\u7801",level:3},{value:"\u9519\u8bef\u7801\u5224\u65ad",id:"\u9519\u8bef\u7801\u5224\u65ad",level:3},{value:"\u8f93\u5165\u9a8c\u8bc1",id:"\u8f93\u5165\u9a8c\u8bc1",level:2},{value:"\u9a8c\u8bc1\u89c4\u5219",id:"\u9a8c\u8bc1\u89c4\u5219",level:3},{value:"\u5b9e\u65f6\u9a8c\u8bc1",id:"\u5b9e\u65f6\u9a8c\u8bc1",level:3},{value:"\u6309\u94ae\u72b6\u6001\u7ba1\u7406",id:"\u6309\u94ae\u72b6\u6001\u7ba1\u7406",level:2},{value:"\u9632\u91cd\u590d\u70b9\u51fb",id:"\u9632\u91cd\u590d\u70b9\u51fb",level:3},{value:"\u5012\u8ba1\u65f6\u7981\u7528",id:"\u5012\u8ba1\u65f6\u7981\u7528",level:3},{value:"\u6ce8\u91ca\u7684\u9519\u8bef\u5904\u7406",id:"\u6ce8\u91ca\u7684\u9519\u8bef\u5904\u7406",level:2},{value:"\u9519\u8bef\u6062\u590d",id:"\u9519\u8bef\u6062\u590d",level:2},{value:"\u6e05\u7a7a\u8f93\u5165",id:"\u6e05\u7a7a\u8f93\u5165",level:3},{value:"\u7126\u70b9\u7ba1\u7406",id:"\u7126\u70b9\u7ba1\u7406",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u5206\u5c42\u5904\u7406",id:"1-\u5206\u5c42\u5904\u7406",level:3},{value:"2. \u9519\u8bef\u4fe1\u606f",id:"2-\u9519\u8bef\u4fe1\u606f",level:3},{value:"3. \u7528\u6237\u4f53\u9a8c",id:"3-\u7528\u6237\u4f53\u9a8c",level:3},{value:"\u6d4b\u8bd5\u8981\u70b9",id:"\u6d4b\u8bd5\u8981\u70b9",level:2},{value:"\u9519\u8bef\u573a\u666f\u6d4b\u8bd5",id:"\u9519\u8bef\u573a\u666f\u6d4b\u8bd5",level:3},{value:"UI\u6d4b\u8bd5",id:"ui\u6d4b\u8bd5",level:3},{value:"\u6062\u590d\u6d4b\u8bd5",id:"\u6062\u590d\u6d4b\u8bd5",level:3},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"Q: \u4e3a\u4ec0\u4e48\u6709\u4e9b\u5730\u65b9\u7528ShowFieldError\uff0c\u6709\u4e9b\u7528PopupManager\uff1f",id:"q-\u4e3a\u4ec0\u4e48\u6709\u4e9b\u5730\u65b9\u7528showfielderror\u6709\u4e9b\u7528popupmanager",level:3},{value:"Q: Toast\u548cPopupManager\u7684\u533a\u522b\uff1f",id:"q-toast\u548cpopupmanager\u7684\u533a\u522b",level:3},{value:"Q: \u4e3a\u4ec0\u4e48\u6709\u4e9b\u9519\u8bef\u5904\u7406\u88ab\u6ce8\u91ca\u4e86\uff1f",id:"q-\u4e3a\u4ec0\u4e48\u6709\u4e9b\u9519\u8bef\u5904\u7406\u88ab\u6ce8\u91ca\u4e86",level:3}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u9519\u8bef\u5904\u7406\u7cfb\u7edf",children:"\u9519\u8bef\u5904\u7406\u7cfb\u7edf"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,i.jsx)(e.p,{children:"\u6e38\u620f\u7684\u9519\u8bef\u5904\u7406\u7cfb\u7edf\u5305\u62ec\u591a\u5c42\u7ea7\u7684\u9519\u8bef\u63d0\u793a\u673a\u5236\uff0c\u4ece\u5b57\u6bb5\u7ea7\u9a8c\u8bc1\u5230\u5168\u5c40\u5f39\u7a97\uff0c\u786e\u4fdd\u7528\u6237\u80fd\u591f\u53ca\u65f6\u4e86\u89e3\u64cd\u4f5c\u7ed3\u679c\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u9519\u8bef\u63d0\u793a\u5c42\u7ea7",children:"\u9519\u8bef\u63d0\u793a\u5c42\u7ea7"}),"\n",(0,i.jsx)(e.h3,{id:"\u63d0\u793a\u7c7b\u578b\u5bf9\u6bd4",children:"\u63d0\u793a\u7c7b\u578b\u5bf9\u6bd4"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,i.jsx)(e.th,{children:"\u4f7f\u7528\u573a\u666f"}),(0,i.jsx)(e.th,{children:"\u6301\u7eed\u65f6\u95f4"}),(0,i.jsx)(e.th,{children:"\u963b\u585e\u64cd\u4f5c"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5b57\u6bb5\u9519\u8bef"})}),(0,i.jsx)(e.td,{children:"\u8f93\u5165\u9a8c\u8bc1"}),(0,i.jsx)(e.td,{children:"\u6301\u7eed\u663e\u793a"}),(0,i.jsx)(e.td,{children:"\u5426"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Toast\u63d0\u793a"})}),(0,i.jsx)(e.td,{children:"\u8f7b\u91cf\u53cd\u9988"}),(0,i.jsx)(e.td,{children:"2\u79d2"}),(0,i.jsx)(e.td,{children:"\u5426"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"PopupManager"})}),(0,i.jsx)(e.td,{children:"\u91cd\u8981\u63d0\u793a"}),(0,i.jsx)(e.td,{children:"\u9700\u624b\u52a8\u5173\u95ed"}),(0,i.jsx)(e.td,{children:"\u662f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Loading\u906e\u7f69"})}),(0,i.jsx)(e.td,{children:"\u7b49\u5f85\u64cd\u4f5c"}),(0,i.jsx)(e.td,{children:"\u64cd\u4f5c\u5b8c\u6210"}),(0,i.jsx)(e.td,{children:"\u662f"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"\u5b57\u6bb5\u7ea7\u9519\u8bef\u63d0\u793a",children:"\u5b57\u6bb5\u7ea7\u9519\u8bef\u63d0\u793a"}),"\n",(0,i.jsx)(e.h3,{id:"showfielderror\u5b9e\u73b0",children:"ShowFieldError\u5b9e\u73b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="AccountAuthController.cs - \u5b57\u6bb5\u9519\u8bef\u63d0\u793a"',children:"// \u5355\u4e2aLabel\u9519\u8bef\u63d0\u793a\r\nprivate void ShowFieldError(Label lbl, string msg, TextField focus = null)\r\n{\r\n    lbl.text = msg;\r\n    lbl.style.color = Color.red;  // \u7ea2\u8272\r\n}\r\n\r\n// \u591a\u4e2aLabel\u9519\u8bef\u63d0\u793a\uff08\u7528\u4e8e\u540c\u7c7b\u591a\u4e2a\u63d0\u793a\u6846\uff09\r\nprivate void ShowFieldError(IEnumerable<Label> lbls, string msg, TextField focus = null)\r\n{\r\n    foreach (var l in lbls)\r\n    {\r\n        l.text = msg;\r\n        l.style.color = Color.red;\r\n    }\r\n}\r\n\r\n// \u6210\u529f\u63d0\u793a\r\nprivate void ShowFieldOk(Label lbl, string msg, TextField focus = null)\r\n{\r\n    lbl.text = msg;\r\n    lbl.style.color = okColor;  // \u7eff\u8272\r\n}\r\n\r\n// \u7eff\u8272\u5b9a\u4e49\r\nprivate static readonly Color okColor = new(0.32f, 0.65f, 0.53f, 1f);\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u8f93\u5165\u9a8c\u8bc1\u9519\u8bef\u63d0\u793a"',children:'// \u8d26\u53f7\u9a8c\u8bc1\r\nif (!IsAccountValid(account))\r\n{\r\n    ShowFieldError(hinterror, "\u8d26\u53f7\u9700\u22655\u4f4d\uff0c\u4ec5\u9650\u82f1\u6587\u6216\u6570\u5b57", accField);\r\n    return false;\r\n}\r\n\r\n// \u5bc6\u7801\u9a8c\u8bc1\r\nif (password.Length < 6 || password.Length > 20)\r\n{\r\n    ShowFieldError(hinterrorpwd, "\u5bc6\u7801\u957f\u5ea6\u97006-20\u4e2a\u5b57\u7b26", pwdField);\r\n    return false;\r\n}\r\n\r\n// \u90ae\u7bb1\u9a8c\u8bc1\r\nif (!IsEmailValid(email))\r\n{\r\n    ShowFieldError(hinterroremail, "\u8bf7\u8f93\u5165\u5408\u6cd5\u90ae\u7bb1\u5730\u5740", emailField);\r\n    return;\r\n}\r\n\r\n// \u9a8c\u8bc1\u7801\u9a8c\u8bc1\r\nif (!Regex.IsMatch(code, @"^\\d{6}$"))\r\n{\r\n    ShowFieldError(hinterroremailcode, "\u9a8c\u8bc1\u7801\u9700\u4e3a 6 \u4f4d\u6570\u5b57", codeField);\r\n    return;\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"ui\u7ed1\u5b9a",children:"UI\u7ed1\u5b9a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9519\u8befLabel\u67e5\u627e"',children:'void Awake()\r\n{\r\n    var root = GetComponent<UIDocument>().rootVisualElement;\r\n    \r\n    /*\u2500\u2500 \u9519\u8bef Label \u2500\u2500*/\r\n    hinterror = root.Q<Label>("hinterror");          // \u8d26\u53f7\u9519\u8bef\r\n    hinterrorpwd = root.Q<Label>("hinterrorpwd");    // \u5bc6\u7801\u9519\u8bef\r\n    \r\n    // \u591a\u4e2a\u540c\u7c7bLabel\r\n    hinterroremail = root.Query<Label>(className: "hinterroremail").ToList();\r\n    hinterroremailcode = root.Query<Label>(className: "hinterroremailcode").ToList();\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"toast\u8f7b\u91cf\u63d0\u793a",children:"Toast\u8f7b\u91cf\u63d0\u793a"}),"\n",(0,i.jsx)(e.h3,{id:"toast\u5b9e\u73b0",children:"Toast\u5b9e\u73b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="AccountAuthController.cs - Toast\u7cfb\u7edf"',children:'/*\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 UI\uff1aToast \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500*/\r\nprivate VisualElement toastPanel;\r\nprivate Label toastText;\r\nprivate Coroutine toastCO;\r\n\r\n// Toast\u663e\u793a\u65b9\u6cd5\r\nprivate void Toast(string message, float duration = 2f)\r\n{\r\n    toastText.text = message;\r\n    toastPanel.AddToClassList("show");\r\n    \r\n    if (toastCO != null) StopCoroutine(toastCO);\r\n    toastCO = StartCoroutine(HideToastAfter(duration));\r\n}\r\n\r\n// \u9690\u85cf\u534f\u7a0b\r\nprivate IEnumerator HideToastAfter(float duration)\r\n{\r\n    yield return new WaitForSeconds(duration);\r\n    toastPanel.RemoveFromClassList("show");\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"toast\u6837\u5f0f",children:"Toast\u6837\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-css",metastring:'title="LogInScreenStyle.uss"',children:".toast {\r\n    position: absolute;\r\n    display: none;\r\n    opacity: 0;\r\n    transition: opacity 0.3s ease;\r\n}\r\n\r\n.toast.show {\r\n    display: flex;\r\n    opacity: 1;\r\n    transition: opacity 0.3s ease;\r\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// \u64cd\u4f5c\u6210\u529f\r\nToast("\u6ce8\u518c\u5e76\u767b\u5f55\u6210\u529f\uff01");\r\nToast("\u9a8c\u8bc1\u6210\u529f\uff0c\u8bf7\u8bbe\u7f6e\u65b0\u5bc6\u7801");\r\n\r\n// \u793a\u4f8b\u63d0\u793a\r\nToast("\uff08\u793a\u4f8b\uff09\u672c\u5730\u6821\u9a8c\u901a\u8fc7\uff0c\u5f85\u63a5\u5165 API");\n'})}),"\n",(0,i.jsx)(e.h2,{id:"popupmanager\u5168\u5c40\u5f39\u7a97",children:"PopupManager\u5168\u5c40\u5f39\u7a97"}),"\n",(0,i.jsx)(e.h3,{id:"popupmanager\u5b9e\u73b0",children:"PopupManager\u5b9e\u73b0"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="PopupManager.cs"',children:'public class PopupManager : MonoBehaviour\r\n{\r\n    static PopupManager inst;\r\n    \r\n    [SerializeField] VisualTreeAsset popupTpl;\r\n    [SerializeField] UIDocument doc;\r\n    \r\n    VisualElement docRoot;\r\n    VHSizer vhSizer;\r\n    \r\n    void Start()\r\n    {\r\n        inst = this;\r\n        if (doc != null)\r\n        {\r\n            docRoot = doc.rootVisualElement;\r\n            vhSizer = GetComponent<VHSizer>();\r\n        }\r\n    }\r\n    \r\n    // \u9759\u6001\u8c03\u7528\u65b9\u6cd5\r\n    public static void Show(string msg, float sec = 0f)\r\n        => inst?.CreatePopup("\u63d0\u793a", msg, sec);\r\n\r\n    public static void Show(string title, string msg, float sec = 0f)\r\n        => inst?.CreatePopup(title, msg, sec);\r\n    \r\n    /*\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u751f\u6210\u5f39\u7a97 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500*/\r\n    void CreatePopup(string title, string msg, float autoClose)\r\n    {\r\n        if (popupTpl == null || docRoot == null) return;\r\n\r\n        // 1) CloneTree \u5e76\u653e\u8fdb Panel\r\n        var root = popupTpl.CloneTree();\r\n        docRoot.Add(root);\r\n        root.BringToFront();\r\n\r\n        // 2) \u6587\u6848 + \u5173\u95ed\u903b\u8f91\r\n        root.Q<Label>("Popuptitle")?.SetText(title);\r\n        var txtLbl = root.Q<Label>("Popuptext");\r\n        if (txtLbl != null)\r\n            txtLbl.SetText(msg);\r\n        txtLbl.style.unityTextAlign = TextAnchor.MiddleCenter;\r\n        \r\n        // \u5173\u95ed\u6309\u94ae\r\n        void Close() => root.RemoveFromHierarchy();\r\n        root.Q<VisualElement>("BlackSpace")?.RegisterCallback<ClickEvent>(_ => Close());\r\n        root.Q<VisualElement>("ClosePanel")?.RegisterCallback<ClickEvent>(_ => Close());\r\n        var btn = root.Q<Button>("CloseBtn2");\r\n        if (btn != null) btn.clicked += Close;\r\n\r\n        // \u81ea\u52a8\u5173\u95ed\r\n        if (autoClose > 0f)\r\n        {\r\n#if UNITY_2022_2_OR_NEWER\r\n            root.schedule.Execute(Close).StartingIn((long)(autoClose * 1000));\r\n#else\r\n            root.schedule.Execute(Close).ExecuteLater((long)(autoClose * 1000));\r\n#endif\r\n        }\r\n\r\n        // 3) \u5f39\u7a97\u52a0\u5165\u540e \u21d2 \u518d\u6267\u884c\u4e00\u6b21\u81ea\u9002\u5e94\r\n        vhSizer?.Apply();\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u793a\u4f8b-1",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="PopupManager\u4f7f\u7528"',children:'// \u7b80\u5355\u63d0\u793a\r\nPopupManager.Show("\u6e38\u5ba2\u767b\u5f55\u5931\u8d25\uff01\\n" + msg);\r\n\r\n// \u5e26\u6807\u9898\u63d0\u793a\r\nPopupManager.Show("\u767b\u5f55\u5931\u8d25", msg);\r\nPopupManager.Show("\u6ce8\u518c\u5931\u8d25", msg);\r\nPopupManager.Show("\u53d1\u9001\u5931\u8d25", msg);\r\nPopupManager.Show("\u64cd\u4f5c\u5931\u8d25", msg);\r\n\r\n// \u8f93\u5165\u63d0\u793a\r\nPopupManager.Show("\u63d0\u793a", "\u5bc6\u7801\u9700\u22658\u4f4d\uff0c\u5e76\u5305\u542b\u5b57\u6bcd\u548c\u6570\u5b57");\r\nPopupManager.Show("\u63d0\u793a", "\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4");\r\n\r\n// \u81ea\u52a8\u5173\u95ed\uff083\u79d2\uff09\r\nPopupManager.Show("\u64cd\u4f5c\u6210\u529f", "\u6570\u636e\u5df2\u4fdd\u5b58", 3f);\n'})}),"\n",(0,i.jsx)(e.h2,{id:"loading\u72b6\u6001\u7ba1\u7406",children:"Loading\u72b6\u6001\u7ba1\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"loadingpanelmanager",children:"LoadingPanelManager"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="LoadingPanelManager.cs"',children:"public class LoadingPanelManager : MonoBehaviour\r\n{\r\n    public static LoadingPanelManager Instance { get; private set; }\r\n\r\n    [SerializeField] Canvas loadingCanvas;\r\n\r\n    void Awake()\r\n    {\r\n        if (Instance != null && Instance != this)\r\n        {\r\n            Destroy(gameObject);\r\n            return;\r\n        }\r\n        Instance = this;\r\n        DontDestroyOnLoad(gameObject);\r\n        Hide();\r\n    }\r\n    \r\n    public void Show() => loadingCanvas.enabled = true;\r\n    public void Hide() => loadingCanvas.enabled = false;\r\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"spincontroller",children:"SpinController"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u5c40\u90e8Loading"',children:"// \u663e\u793a\u5c0f\u8f6c\u5708\r\nSpinController.Instance.Show();\r\n\r\n// \u9690\u85cf\u8f6c\u5708\r\nSpinController.Instance.Hide();\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528\u573a\u666f-1",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// \u767b\u5f55\u65f6\u663e\u793a\u5168\u5c4fLoading\r\nLoadingPanelManager.Instance.Show();\r\n\r\napi.PasswordLogin(account, password,\r\n    ok: _ => {\r\n        // \u6210\u529f\u4e0d\u9690\u85cf\uff0c\u76f4\u63a5\u8df3\u8f6c\u573a\u666f\r\n        SceneManager.LoadScene("LoadingScene");\r\n    },\r\n    fail: _ => {\r\n        // \u5931\u8d25\u65f6\u9690\u85cf\r\n        LoadingPanelManager.Instance.Hide();\r\n        PopupManager.Show("\u767b\u5f55\u5931\u8d25", msg);\r\n    }\r\n);\r\n\r\n// \u9a8c\u8bc1\u7801\u53d1\u9001\u663e\u793a\u5c40\u90e8Loading\r\nSpinController.Instance.Show();\r\napi.GetEmailCode(email,\r\n    ok: _ => SpinController.Instance.Hide(),\r\n    fail: _ => SpinController.Instance.Hide()\r\n);\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u9519\u8bef\u7801\u4f53\u7cfb",children:"\u9519\u8bef\u7801\u4f53\u7cfb"}),"\n",(0,i.jsx)(e.h3,{id:"http\u9519\u8bef\u7801",children:"HTTP\u9519\u8bef\u7801"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="AuthAPI\u9519\u8bef\u5904\u7406"',children:'IEnumerator PostJson(string url, string json,\r\n                     Action<string> ok, Action<string> fail)\r\n{\r\n    // ... \u53d1\u9001\u8bf7\u6c42\r\n    \r\n    if (req.result != UnityWebRequest.Result.Success)\r\n    {\r\n        fail?.Invoke($"{req.responseCode} {req.error}");\r\n        yield break;\r\n    }\r\n\r\n    var resp = JsonUtility.FromJson<ApiResp>(req.downloadHandler.text);\r\n    if (resp.code == 0)\r\n        ok?.Invoke(req.downloadHandler.text);\r\n    else\r\n        fail?.Invoke($"{resp.code} {resp.message}");\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u9519\u8bef\u7801\u5224\u65ad",children:"\u9519\u8bef\u7801\u5224\u65ad"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// \u7279\u5b9a\u9519\u8bef\u7801\u5904\u7406\r\nif (msg.StartsWith("1"))  // \u7528\u6237\u540d\u76f8\u5173\r\n{\r\n    lastCheckedName = nameTrying;\r\n    lastNameIsUsable = false;\r\n    ShowFieldError(hinterror, "\u7528\u6237\u540d\u5df2\u5b58\u5728", regAccField);\r\n}\r\nelse\r\n{\r\n    // \u5176\u4ed6\u9519\u8bef\r\n    PopupManager.Show("\u6ce8\u518c\u5931\u8d25", msg);\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u8f93\u5165\u9a8c\u8bc1",children:"\u8f93\u5165\u9a8c\u8bc1"}),"\n",(0,i.jsx)(e.h3,{id:"\u9a8c\u8bc1\u89c4\u5219",children:"\u9a8c\u8bc1\u89c4\u5219"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u8f93\u5165\u9a8c\u8bc1\u65b9\u6cd5"',children:'// \u8d26\u53f7\u9a8c\u8bc1\r\nprivate static bool IsAccountValid(string acc) =>\r\n    Regex.IsMatch(acc, @"^[A-Za-z0-9]{5,32}$");\r\n\r\n// \u5bc6\u7801\u5f3a\u5ea6\u9a8c\u8bc1\r\nprivate static bool IsPasswordStrong(string pwd) =>\r\n    Regex.IsMatch(pwd, @"^(?=.*\\d)(?=.*[A-Za-z]).{8,}$");\r\n\r\n// \u5bc6\u7801\u5339\u914d\r\nprivate static bool IsPasswordMatch(string a, string b) => a == b;\r\n\r\n// \u90ae\u7bb1\u9a8c\u8bc1\r\nprivate bool IsEmailValid(string email)\r\n{\r\n    if (string.IsNullOrEmpty(email))\r\n        return false;\r\n    string pattern = @"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$";\r\n    return Regex.IsMatch(email, pattern);\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u5b9e\u65f6\u9a8c\u8bc1",children:"\u5b9e\u65f6\u9a8c\u8bc1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9a8c\u8bc1\u7801\u8f93\u5165\u8fc7\u6ee4"',children:'// \u9a8c\u8bc1\u7801\u53ea\u5141\u8bb8\u6570\u5b57\r\nprivate void OnEmailCodeChanged(ChangeEvent<string> evt)\r\n{\r\n    var field = (TextField)evt.target;\r\n    string pure = Regex.Replace(evt.newValue ?? "", @"[^\\d]", "");\r\n    \r\n    if (pure != evt.newValue)\r\n    {\r\n        field.SetValueWithoutNotify(pure);\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u6309\u94ae\u72b6\u6001\u7ba1\u7406",children:"\u6309\u94ae\u72b6\u6001\u7ba1\u7406"}),"\n",(0,i.jsx)(e.h3,{id:"\u9632\u91cd\u590d\u70b9\u51fb",children:"\u9632\u91cd\u590d\u70b9\u51fb"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u6309\u94ae\u7981\u7528"',children:"// \u70b9\u51fb\u540e\u7981\u7528\r\nloginBtn?.SetEnabled(false);\r\n\r\napi.PasswordLogin(account, password,\r\n    ok: _ => loginBtn?.SetEnabled(true),\r\n    fail: _ => loginBtn?.SetEnabled(true)\r\n);\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5012\u8ba1\u65f6\u7981\u7528",children:"\u5012\u8ba1\u65f6\u7981\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9a8c\u8bc1\u7801\u6309\u94ae\u5012\u8ba1\u65f6"',children:'private IEnumerator ButtonCooldown(Button btn, int seconds)\r\n{\r\n    string originalText = btn.text;\r\n    btn.SetEnabled(false);\r\n    \r\n    for (int i = seconds; i > 0; i--)\r\n    {\r\n        btn.text = $"{i}\u79d2";\r\n        yield return new WaitForSeconds(1f);\r\n    }\r\n    \r\n    btn.text = originalText;\r\n    btn.SetEnabled(true);\r\n    cooldownCO = null;\r\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u6ce8\u91ca\u7684\u9519\u8bef\u5904\u7406",children:"\u6ce8\u91ca\u7684\u9519\u8bef\u5904\u7406"}),"\n",(0,i.jsx)(e.p,{children:"\u9879\u76ee\u4e2d\u6709\u4e9b\u9519\u8bef\u5904\u7406\u88ab\u6ce8\u91ca\u4e86\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:'// PopupManager\u88ab\u6ce8\u91ca\u7684\u5730\u65b9\r\nonFail: err =>\r\n{\r\n    LoadingPanelManager.Instance.Hide();\r\n    //PopupManager.Show("\u8fde\u63a5\u6218\u6597\u670d\u5931\u8d25", err);\r\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u80fd\u539f\u56e0\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"\u907f\u514d\u91cd\u590d\u63d0\u793a"}),"\n",(0,i.jsx)(e.li,{children:"\u6709\u5176\u4ed6\u9519\u8bef\u5904\u7406\u673a\u5236"}),"\n",(0,i.jsx)(e.li,{children:"\u8c03\u8bd5\u671f\u95f4\u4e34\u65f6\u6ce8\u91ca"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u9519\u8bef\u6062\u590d",children:"\u9519\u8bef\u6062\u590d"}),"\n",(0,i.jsx)(e.h3,{id:"\u6e05\u7a7a\u8f93\u5165",children:"\u6e05\u7a7a\u8f93\u5165"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9519\u8bef\u540e\u6e05\u7a7a"',children:'private void ClearAllInputs()\r\n{\r\n    var root = GetComponent<UIDocument>().rootVisualElement;\r\n    root.Query<TextField>(className: "textinput")\r\n        .ForEach(tf => tf.value = string.Empty);\r\n    ResetErrorTexts();\r\n}\r\n\r\nprivate void ResetErrorTexts()\r\n{\r\n    hinterror.text = " ";\r\n    hinterrorpwd.text = " ";\r\n    foreach (var l in hinterroremail) l.text = " ";\r\n    foreach (var l in hinterroremailcode) l.text = " ";\r\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u7126\u70b9\u7ba1\u7406",children:"\u7126\u70b9\u7ba1\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-csharp",children:"private void Focus(TextField tf) =>\r\n    tf?.schedule.Execute(() => tf.Focus()).ExecuteLater(0);\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u5206\u5c42\u5904\u7406",children:"1. \u5206\u5c42\u5904\u7406"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8f93\u5165\u9a8c\u8bc1\u7528\u5b57\u6bb5\u9519\u8bef"}),"\n",(0,i.jsx)(e.li,{children:"\u64cd\u4f5c\u6210\u529f\u7528Toast"}),"\n",(0,i.jsx)(e.li,{children:"\u91cd\u8981\u9519\u8bef\u7528PopupManager"}),"\n",(0,i.jsx)(e.li,{children:"\u7b49\u5f85\u64cd\u4f5c\u7528Loading"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"2-\u9519\u8bef\u4fe1\u606f",children:"2. \u9519\u8bef\u4fe1\u606f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u660e\u786e\u8bf4\u660e\u95ee\u9898"}),"\n",(0,i.jsx)(e.li,{children:"\u63d0\u4f9b\u89e3\u51b3\u5efa\u8bae"}),"\n",(0,i.jsx)(e.li,{children:"\u907f\u514d\u6280\u672f\u672f\u8bed"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"3-\u7528\u6237\u4f53\u9a8c",children:"3. \u7528\u6237\u4f53\u9a8c"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5373\u65f6\u53cd\u9988"}),"\n",(0,i.jsx)(e.li,{children:"\u975e\u963b\u585e\u63d0\u793a\u4f18\u5148"}),"\n",(0,i.jsx)(e.li,{children:"\u81ea\u52a8\u6062\u590d\u7126\u70b9"}),"\n",(0,i.jsx)(e.li,{children:"\u6e05\u7406\u9519\u8bef\u72b6\u6001"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u6d4b\u8bd5\u8981\u70b9",children:"\u6d4b\u8bd5\u8981\u70b9"}),"\n",(0,i.jsx)(e.h3,{id:"\u9519\u8bef\u573a\u666f\u6d4b\u8bd5",children:"\u9519\u8bef\u573a\u666f\u6d4b\u8bd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5404\u79cd\u8f93\u5165\u9519\u8bef"}),"\n",(0,i.jsx)(e.li,{children:"\u7f51\u7edc\u5f02\u5e38"}),"\n",(0,i.jsx)(e.li,{children:"\u670d\u52a1\u5668\u9519\u8bef"}),"\n",(0,i.jsx)(e.li,{children:"\u8d85\u65f6\u5904\u7406"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"ui\u6d4b\u8bd5",children:"UI\u6d4b\u8bd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9519\u8bef\u63d0\u793a\u663e\u793a\u6b63\u786e"}),"\n",(0,i.jsx)(e.li,{children:"Toast\u81ea\u52a8\u6d88\u5931"}),"\n",(0,i.jsx)(e.li,{children:"\u5f39\u7a97\u53ef\u4ee5\u5173\u95ed"}),"\n",(0,i.jsx)(e.li,{children:"Loading\u6b63\u786e\u663e\u793a/\u9690\u85cf"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u6062\u590d\u6d4b\u8bd5",children:"\u6062\u590d\u6d4b\u8bd5"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u9519\u8bef\u540e\u53ef\u91cd\u8bd5"}),"\n",(0,i.jsx)(e.li,{children:"\u8f93\u5165\u6846\u6b63\u786e\u6e05\u7a7a"}),"\n",(0,i.jsx)(e.li,{children:"\u6309\u94ae\u72b6\u6001\u6062\u590d"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,i.jsx)(e.h3,{id:"q-\u4e3a\u4ec0\u4e48\u6709\u4e9b\u5730\u65b9\u7528showfielderror\u6709\u4e9b\u7528popupmanager",children:"Q: \u4e3a\u4ec0\u4e48\u6709\u4e9b\u5730\u65b9\u7528ShowFieldError\uff0c\u6709\u4e9b\u7528PopupManager\uff1f"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"A:"})," ShowFieldError\u7528\u4e8e\u8f93\u5165\u9a8c\u8bc1\u7b49\u8f7b\u91cf\u63d0\u793a\uff0cPopupManager\u7528\u4e8e\u9700\u8981\u7528\u6237\u786e\u8ba4\u7684\u91cd\u8981\u4fe1\u606f\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"q-toast\u548cpopupmanager\u7684\u533a\u522b",children:"Q: Toast\u548cPopupManager\u7684\u533a\u522b\uff1f"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"A:"})," Toast\u662f\u975e\u963b\u585e\u7684\u8f7b\u91cf\u63d0\u793a\uff0c\u81ea\u52a8\u6d88\u5931\uff1bPopupManager\u662f\u6a21\u6001\u5f39\u7a97\uff0c\u9700\u8981\u624b\u52a8\u5173\u95ed\u3002"]}),"\n",(0,i.jsx)(e.h3,{id:"q-\u4e3a\u4ec0\u4e48\u6709\u4e9b\u9519\u8bef\u5904\u7406\u88ab\u6ce8\u91ca\u4e86",children:"Q: \u4e3a\u4ec0\u4e48\u6709\u4e9b\u9519\u8bef\u5904\u7406\u88ab\u6ce8\u91ca\u4e86\uff1f"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"A:"})," \u53ef\u80fd\u662f\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u63d0\u793a\uff0c\u6216\u8005\u8c03\u8bd5\u65f6\u4e34\u65f6\u6ce8\u91ca\uff0c\u9700\u8981\u6839\u636e\u5b9e\u9645\u9700\u6c42\u51b3\u5b9a\u662f\u5426\u542f\u7528\u3002"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>s});var l=r(6540);const i={},t=l.createContext(i);function a(n){const e=l.useContext(t);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),l.createElement(t.Provider,{value:e},n.children)}}}]);