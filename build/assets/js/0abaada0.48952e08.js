"use strict";(self.webpackChunkgame_docs=self.webpackChunkgame_docs||[]).push([[813],{5233:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"\u767b\u5f55/account-login","title":"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55","description":"\u529f\u80fd\u6982\u8ff0","source":"@site/docs/\u767b\u5f55/account-login.md","sourceDirName":"\u767b\u5f55","slug":"/\u767b\u5f55/account-login","permalink":"/ROL_Docs/docs/\u767b\u5f55/account-login","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"account-login","title":"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55","sidebar_label":"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"\u767b\u5f55\u7cfb\u7edf","permalink":"/ROL_Docs/docs/\u767b\u5f55/login-overview"},"next":{"title":"\u6ce8\u518c\u7cfb\u7edf","permalink":"/ROL_Docs/docs/\u767b\u5f55/register-system"}}');var l=r(4848),t=r(8453);const s={id:"account-login",title:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55",sidebar_label:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55",sidebar_position:2},a="\u8d26\u53f7\u5bc6\u7801\u767b\u5f55",d={},c=[{value:"\u529f\u80fd\u6982\u8ff0",id:"\u529f\u80fd\u6982\u8ff0",level:2},{value:"\u6280\u672f\u5b9e\u73b0",id:"\u6280\u672f\u5b9e\u73b0",level:2},{value:"\u767b\u5f55\u6d41\u7a0b",id:"\u767b\u5f55\u6d41\u7a0b",level:3},{value:"\u5bc6\u7801\u52a0\u5bc6\u673a\u5236",id:"\u5bc6\u7801\u52a0\u5bc6\u673a\u5236",level:3},{value:"\u53cc\u91cdSHA256\u52a0\u5bc6",id:"\u53cc\u91cdsha256\u52a0\u5bc6",level:4},{value:"\u52a0\u5bc6\u5b9e\u73b0\u7ec6\u8282",id:"\u52a0\u5bc6\u5b9e\u73b0\u7ec6\u8282",level:4},{value:"\u8f93\u5165\u9a8c\u8bc1",id:"\u8f93\u5165\u9a8c\u8bc1",level:3},{value:"\u8d26\u53f7\u9a8c\u8bc1\u89c4\u5219",id:"\u8d26\u53f7\u9a8c\u8bc1\u89c4\u5219",level:4},{value:"\u5b9e\u65f6\u9a8c\u8bc1\u53cd\u9988",id:"\u5b9e\u65f6\u9a8c\u8bc1\u53cd\u9988",level:4},{value:"UI\u754c\u9762",id:"ui\u754c\u9762",level:2},{value:"\u767b\u5f55\u9762\u677f\u5e03\u5c40",id:"\u767b\u5f55\u9762\u677f\u5e03\u5c40",level:3},{value:"\u6837\u5f0f\u5b9a\u4e49",id:"\u6837\u5f0f\u5b9a\u4e49",level:3},{value:"\u670d\u52a1\u5668\u4ea4\u4e92",id:"\u670d\u52a1\u5668\u4ea4\u4e92",level:2},{value:"API\u63a5\u53e3",id:"api\u63a5\u53e3",level:3},{value:"\u767b\u5f55\u63a5\u53e3",id:"\u767b\u5f55\u63a5\u53e3",level:4},{value:"\u54cd\u5e94\u683c\u5f0f",id:"\u54cd\u5e94\u683c\u5f0f",level:4},{value:"\u9519\u8bef\u7801\u8bf4\u660e",id:"\u9519\u8bef\u7801\u8bf4\u660e",level:3},{value:"\u5b89\u5168\u63aa\u65bd",id:"\u5b89\u5168\u63aa\u65bd",level:2},{value:"1. \u5bc6\u7801\u52a0\u5bc6\u4f20\u8f93",id:"1-\u5bc6\u7801\u52a0\u5bc6\u4f20\u8f93",level:3},{value:"2. \u9632\u91cd\u590d\u70b9\u51fb",id:"2-\u9632\u91cd\u590d\u70b9\u51fb",level:3},{value:"3. \u65f6\u95f4\u6233\u9632\u91cd\u653e",id:"3-\u65f6\u95f4\u6233\u9632\u91cd\u653e",level:3},{value:"\u7528\u6237\u4f53\u9a8c\u4f18\u5316",id:"\u7528\u6237\u4f53\u9a8c\u4f18\u5316",level:2},{value:"1. \u6e05\u7a7a\u8f93\u5165",id:"1-\u6e05\u7a7a\u8f93\u5165",level:3},{value:"2. \u9632\u91cd\u590d\u70b9\u51fb",id:"2-\u9632\u91cd\u590d\u70b9\u51fb-1",level:3},{value:"3. Loading\u53cd\u9988",id:"3-loading\u53cd\u9988",level:3},{value:"\u6d4b\u8bd5\u8981\u70b9",id:"\u6d4b\u8bd5\u8981\u70b9",level:2},{value:"\u529f\u80fd\u6d4b\u8bd5\u6e05\u5355",id:"\u529f\u80fd\u6d4b\u8bd5\u6e05\u5355",level:3},{value:"\u8fb9\u754c\u6761\u4ef6",id:"\u8fb9\u754c\u6761\u4ef6",level:3},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"Q: \u4e3a\u4ec0\u4e48\u4f7f\u7528\u53cc\u91cdSHA256\uff1f",id:"q-\u4e3a\u4ec0\u4e48\u4f7f\u7528\u53cc\u91cdsha256",level:3},{value:"Q: \u5982\u4f55\u5904\u7406\u5bc6\u7801\u627e\u56de\uff1f",id:"q-\u5982\u4f55\u5904\u7406\u5bc6\u7801\u627e\u56de",level:3},{value:"Q: \u767b\u5f55\u5931\u8d25\u600e\u4e48\u529e\uff1f",id:"q-\u767b\u5f55\u5931\u8d25\u600e\u4e48\u529e",level:3}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55",children:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55"})}),"\n",(0,l.jsx)(e.h2,{id:"\u529f\u80fd\u6982\u8ff0",children:"\u529f\u80fd\u6982\u8ff0"}),"\n",(0,l.jsx)(e.p,{children:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55\u662f\u6e38\u620f\u7684\u4f20\u7edf\u767b\u5f55\u65b9\u5f0f\uff0c\u63d0\u4f9b\u5b8c\u6574\u7684\u8d26\u53f7\u4f53\u7cfb\uff0c\u5305\u62ec\u767b\u5f55\u3001\u6ce8\u518c\u3001\u5bc6\u7801\u627e\u56de\u7b49\u529f\u80fd\u3002"}),"\n",(0,l.jsx)(e.h2,{id:"\u6280\u672f\u5b9e\u73b0",children:"\u6280\u672f\u5b9e\u73b0"}),"\n",(0,l.jsx)(e.h3,{id:"\u767b\u5f55\u6d41\u7a0b",children:"\u767b\u5f55\u6d41\u7a0b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-mermaid",children:"graph TD\r\n    A[\u7528\u6237\u8f93\u5165\u8d26\u53f7\u5bc6\u7801] --\x3e B[\u5ba2\u6237\u7aef\u9a8c\u8bc1\u683c\u5f0f]\r\n    B --\x3e C{\u683c\u5f0f\u6b63\u786e?}\r\n    C --\x3e|\u5426| D[\u663e\u793a\u9519\u8bef\u63d0\u793a]\r\n    C --\x3e|\u662f| E[SHA256\u52a0\u5bc6]\r\n    E --\x3e F[\u6dfb\u52a0\u65f6\u95f4\u6233]\r\n    F --\x3e G[\u4e8c\u6b21SHA256]\r\n    G --\x3e H[\u53d1\u9001\u5230\u670d\u52a1\u5668]\r\n    H --\x3e I{\u670d\u52a1\u5668\u9a8c\u8bc1}\r\n    I --\x3e|\u5931\u8d25| J[\u8fd4\u56de\u9519\u8bef\u7801]\r\n    I --\x3e|\u6210\u529f| K[\u8fd4\u56de\u7528\u6237\u4fe1\u606f]\r\n    K --\x3e L[\u8fde\u63a5\u6218\u6597\u670d]\r\n    L --\x3e M[\u8fdb\u5165\u6e38\u620f]\n"})}),"\n",(0,l.jsx)(e.h3,{id:"\u5bc6\u7801\u52a0\u5bc6\u673a\u5236",children:"\u5bc6\u7801\u52a0\u5bc6\u673a\u5236"}),"\n",(0,l.jsx)(e.h4,{id:"\u53cc\u91cdsha256\u52a0\u5bc6",children:"\u53cc\u91cdSHA256\u52a0\u5bc6"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AccountAuthController.cs"',children:'private void OnClickLogin()\r\n{\r\n    string account = loginAccField.value.Trim();\r\n    string password = loginPwdField.value;\r\n    \r\n    // \u8f93\u5165\u9a8c\u8bc1\r\n    if (!CheckAccountAndPwd(account, password)) \r\n        return;\r\n    \r\n    // \u663e\u793a\u52a0\u8f7d\u52a8\u753b\r\n    LoadingPanelManager.Instance.Show();\r\n    \r\n    // \u53d1\u8d77\u767b\u5f55\u8bf7\u6c42\r\n    api.PasswordLogin(\r\n        account,\r\n        password,\r\n        ok: json => {\r\n            // \u4fdd\u5b58\u4f1a\u8bdd\u4fe1\u606f\r\n            SaveSession(json);\r\n            \r\n            // \u8fde\u63a5\u6218\u6597\u670d\r\n            BattleServerBridge.Connect(json,\r\n                onOk: _ => {\r\n                    SceneManager.LoadScene("LoadingScene");\r\n                },\r\n                onFail: err => {\r\n                    LoadingPanelManager.Instance.Hide();\r\n                    PopupManager.Show("\u8fde\u63a5\u5931\u8d25", err);\r\n                });\r\n        },\r\n        fail: msg => {\r\n            LoadingPanelManager.Instance.Hide();\r\n            PopupManager.Show("\u767b\u5f55\u5931\u8d25", msg);\r\n        });\r\n}\n'})}),"\n",(0,l.jsx)(e.h4,{id:"\u52a0\u5bc6\u5b9e\u73b0\u7ec6\u8282",children:"\u52a0\u5bc6\u5b9e\u73b0\u7ec6\u8282"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AuthAPI.cs"',children:'public Coroutine PasswordLogin(string account, string rawPwd,\r\n                               Action<string> ok, Action<string> fail)\r\n{\r\n    // \u751f\u6210\u65f6\u95f4\u6233\uff08\u6beb\u79d2\u7ea7\uff09\r\n    long ts = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();\r\n    string tsStr = ts.ToString();\r\n    \r\n    // \u7b2c\u4e00\u6b21SHA256\uff1a\u539f\u59cb\u5bc6\u7801\u54c8\u5e0c\r\n    string sha1 = Sha256Hex(rawPwd);\r\n    \r\n    // \u7b2c\u4e8c\u6b21SHA256\uff1a\u52a0\u5165\u65f6\u95f4\u6233\u9632\u91cd\u653e\r\n    string sha2 = Sha256Hex(sha1 + tsStr);\r\n    \r\n    // \u6784\u5efa\u8bf7\u6c42\u4f53\r\n    string url = $"{host}/user/PasswordLogin";\r\n    string body = JsonUtility.ToJson(new {\r\n        username = account,\r\n        password = sha2,\r\n        timestamp = tsStr\r\n    });\r\n    \r\n    return StartCoroutine(PostJson(url, body, ok, fail));\r\n}\r\n\r\n// SHA256\u5b9e\u73b0\r\nprivate string Sha256Hex(string input)\r\n{\r\n    using (SHA256 sha256 = SHA256.Create())\r\n    {\r\n        byte[] bytes = Encoding.UTF8.GetBytes(input);\r\n        byte[] hash = sha256.ComputeHash(bytes);\r\n        return BitConverter.ToString(hash)\r\n            .Replace("-", "").ToLowerInvariant();\r\n    }\r\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u8f93\u5165\u9a8c\u8bc1",children:"\u8f93\u5165\u9a8c\u8bc1"}),"\n",(0,l.jsx)(e.h4,{id:"\u8d26\u53f7\u9a8c\u8bc1\u89c4\u5219",children:"\u8d26\u53f7\u9a8c\u8bc1\u89c4\u5219"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9a8c\u8bc1\u903b\u8f91"',children:'private bool CheckAccountAndPwd(TextField accField, TextField pwdField)\r\n{\r\n    string account = accField.value.Trim();\r\n    string password = pwdField.value;\r\n    \r\n    // \u8d26\u53f7\u957f\u5ea6\u68c0\u67e5\uff1a3-20\u5b57\u7b26\r\n    if (account.Length < 3 || account.Length > 20)\r\n    {\r\n        ShowFieldError(hinterror, "\u8d26\u53f7\u957f\u5ea6\u97003-20\u4e2a\u5b57\u7b26", accField);\r\n        return false;\r\n    }\r\n    \r\n    // \u8d26\u53f7\u683c\u5f0f\u68c0\u67e5\uff1a\u4ec5\u5141\u8bb8\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf\r\n    if (!Regex.IsMatch(account, @"^[a-zA-Z0-9_]+$"))\r\n    {\r\n        ShowFieldError(hinterror, "\u8d26\u53f7\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf", accField);\r\n        return false;\r\n    }\r\n    \r\n    // \u5bc6\u7801\u957f\u5ea6\u68c0\u67e5\uff1a6-20\u5b57\u7b26\r\n    if (password.Length < 6 || password.Length > 20)\r\n    {\r\n        ShowFieldError(hinterrorpwd, "\u5bc6\u7801\u957f\u5ea6\u97006-20\u4e2a\u5b57\u7b26", pwdField);\r\n        return false;\r\n    }\r\n    \r\n    return true;\r\n}\n'})}),"\n",(0,l.jsx)(e.h4,{id:"\u5b9e\u65f6\u9a8c\u8bc1\u53cd\u9988",children:"\u5b9e\u65f6\u9a8c\u8bc1\u53cd\u9988"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="\u9519\u8bef\u63d0\u793a\u7cfb\u7edf"',children:'// \u663e\u793a\u5b57\u6bb5\u9519\u8bef\r\nprivate void ShowFieldError(Label errorLabel, string msg, TextField field)\r\n{\r\n    errorLabel.text = msg;\r\n    errorLabel.style.color = new Color(0.7f, 0.14f, 0.14f);  // \u7ea2\u8272\r\n    field.AddToClassList("error");\r\n    \r\n    // 3\u79d2\u540e\u81ea\u52a8\u6e05\u9664\r\n    StartCoroutine(ClearErrorAfter(3f, errorLabel, field));\r\n}\r\n\r\n// \u663e\u793a\u6210\u529f\u63d0\u793a\r\nprivate void ShowFieldOk(List<Label> labels, string msg, TextField field)\r\n{\r\n    foreach (var label in labels)\r\n    {\r\n        label.text = msg;\r\n        label.style.color = new Color(0.32f, 0.65f, 0.53f);  // \u7eff\u8272\r\n    }\r\n    field.RemoveFromClassList("error");\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"ui\u754c\u9762",children:"UI\u754c\u9762"}),"\n",(0,l.jsx)(e.h3,{id:"\u767b\u5f55\u9762\u677f\u5e03\u5c40",children:"\u767b\u5f55\u9762\u677f\u5e03\u5c40"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-xml",metastring:'title="LogInScreenVisualTree.uxml"',children:'<ui:VisualElement name="AccountLoginPanel">\r\n    \x3c!-- \u8d26\u53f7\u8f93\u5165 --\x3e\r\n    <ui:VisualElement name="AccountPanel" class="bar">\r\n        <ui:TextField \r\n            placeholder-text="\u8f93\u5165\u8d26\u53f7" \r\n            name="account-input" \r\n            class="textinput"/>\r\n    </ui:VisualElement>\r\n    \r\n    \x3c!-- \u9519\u8bef\u63d0\u793a --\x3e\r\n    <ui:Label name="hinterror" class="hint"/>\r\n    \r\n    \x3c!-- \u5bc6\u7801\u8f93\u5165 --\x3e\r\n    <ui:VisualElement name="PasswordPanel" class="bar">\r\n        <ui:TextField \r\n            placeholder-text="\u8f93\u5165\u5bc6\u7801" \r\n            password="true"\r\n            name="pwd-input" \r\n            class="textinput"/>\r\n    </ui:VisualElement>\r\n    \r\n    <ui:Label name="hinterrorpwd" class="hint"/>\r\n    \r\n    \x3c!-- \u529f\u80fd\u6309\u94ae --\x3e\r\n    <ui:VisualElement name="ButtonGroup">\r\n        <ui:Button text="\u5fd8\u8bb0\u5bc6\u7801?" name="ForgetPwdBtn"/>\r\n        <ui:Button text="\u8fd8\u6ca1\u8d26\u53f7?" name="RegisterButton"/>\r\n    </ui:VisualElement>\r\n    \r\n    \x3c!-- \u767b\u5f55\u6309\u94ae --\x3e\r\n    <ui:Button text="\u767b\u5f55" name="LoginBtn" class="brownbutton"/>\r\n    \r\n    \x3c!-- \u534f\u8bae\u63d0\u793a --\x3e\r\n    <ui:Label text="\u767b\u5f55\u5373\u8868\u793a\u4f60\u5df2\u540c\u610f\u7528\u6237\u534f\u8bae\u4e0e\u9690\u79c1\u653f\u7b56"/>\r\n</ui:VisualElement>\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u6837\u5f0f\u5b9a\u4e49",children:"\u6837\u5f0f\u5b9a\u4e49"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-css",metastring:'title="LogInScreenStyle.uss"',children:'/* \u8f93\u5165\u6846\u6837\u5f0f */\r\n.bar {\r\n    background-image: url("\u8f93\u5165\u8d26\u53f7\u6846.png");\r\n    border-radius: 10px;\r\n    width: 100%;\r\n    height: 45%;\r\n    margin-top: 10px;\r\n}\r\n\r\n.textinput {\r\n    background-color: transparent;\r\n    border-width: 0;\r\n    font-size: 35px;\r\n    color: rgb(251, 231, 178);\r\n    -unity-text-align: middle-left;\r\n    padding-left: 20px;\r\n}\r\n\r\n/* \u9519\u8bef\u63d0\u793a\u6837\u5f0f */\r\n.hint {\r\n    font-size: 25px;\r\n    height: 30px;\r\n    margin-top: 5px;\r\n    -unity-text-align: middle-center;\r\n}\r\n\r\n/* \u9519\u8bef\u72b6\u6001 */\r\n.error {\r\n    border-color: rgb(180, 35, 35);\r\n    border-width: 2px;\r\n}\r\n\r\n/* \u767b\u5f55\u6309\u94ae */\r\n.brownbutton {\r\n    background-image: url("\u767b\u5f55\u6309\u94ae.png");\r\n    background-size: 45% 100%;\r\n    font-size: 45px;\r\n    color: rgb(251, 231, 178);\r\n    height: 10.5%;\r\n    margin-top: 20px;\r\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"\u670d\u52a1\u5668\u4ea4\u4e92",children:"\u670d\u52a1\u5668\u4ea4\u4e92"}),"\n",(0,l.jsx)(e.h3,{id:"api\u63a5\u53e3",children:"API\u63a5\u53e3"}),"\n",(0,l.jsx)(e.h4,{id:"\u767b\u5f55\u63a5\u53e3",children:"\u767b\u5f55\u63a5\u53e3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-http",children:'POST /user/PasswordLogin\r\nContent-Type: application/json\r\n\r\n{\r\n    "username": "\u7528\u6237\u540d",\r\n    "password": "SHA256\u52a0\u5bc6\u540e\u7684\u5bc6\u7801",\r\n    "timestamp": "\u65f6\u95f4\u6233"\r\n}\n'})}),"\n",(0,l.jsx)(e.h4,{id:"\u54cd\u5e94\u683c\u5f0f",children:"\u54cd\u5e94\u683c\u5f0f"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",metastring:'title="\u6210\u529f\u54cd\u5e94"',children:'{\r\n    "code": 0,\r\n    "message": "success",\r\n    "uid": "user_123456",\r\n    "user_token": "token_xxxxx",\r\n    "cid": "character_123",\r\n    "character_token": "char_token_xxx",\r\n    "server_id": 1,\r\n    "server_ip_address": "192.168.1.100",\r\n    "server_port": 8000\r\n}\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",metastring:'title="\u5931\u8d25\u54cd\u5e94"',children:'{\r\n    "code": 201,\r\n    "message": "\u5bc6\u7801\u9519\u8bef"\r\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u9519\u8bef\u7801\u8bf4\u660e",children:"\u9519\u8bef\u7801\u8bf4\u660e"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\u9519\u8bef\u7801"}),(0,l.jsx)(e.th,{children:"\u542b\u4e49"}),(0,l.jsx)(e.th,{children:"\u7528\u6237\u63d0\u793a"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"0"}),(0,l.jsx)(e.td,{children:"\u6210\u529f"}),(0,l.jsx)(e.td,{children:"-"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"101"}),(0,l.jsx)(e.td,{children:"\u7528\u6237\u540d\u4e0d\u5b58\u5728"}),(0,l.jsx)(e.td,{children:"\u8d26\u53f7\u4e0d\u5b58\u5728\uff0c\u8bf7\u5148\u6ce8\u518c"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"102"}),(0,l.jsx)(e.td,{children:"\u7528\u6237\u540d\u683c\u5f0f\u9519\u8bef"}),(0,l.jsx)(e.td,{children:"\u8d26\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"201"}),(0,l.jsx)(e.td,{children:"\u5bc6\u7801\u9519\u8bef"}),(0,l.jsx)(e.td,{children:"\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"202"}),(0,l.jsx)(e.td,{children:"\u5bc6\u7801\u683c\u5f0f\u9519\u8bef"}),(0,l.jsx)(e.td,{children:"\u5bc6\u7801\u683c\u5f0f\u4e0d\u6b63\u786e"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"401"}),(0,l.jsx)(e.td,{children:"\u8bf7\u6c42\u683c\u5f0f\u9519\u8bef"}),(0,l.jsx)(e.td,{children:"\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"501"}),(0,l.jsx)(e.td,{children:"\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef"}),(0,l.jsx)(e.td,{children:"\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"})]})]})]}),"\n",(0,l.jsx)(e.h2,{id:"\u5b89\u5168\u63aa\u65bd",children:"\u5b89\u5168\u63aa\u65bd"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u5bc6\u7801\u52a0\u5bc6\u4f20\u8f93",children:"1. \u5bc6\u7801\u52a0\u5bc6\u4f20\u8f93"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AuthAPI.cs - \u5b9e\u9645\u5b9e\u73b0"',children:"// \u53cc\u91cdSHA256\u52a0\u5bc6\uff0c\u786e\u4fdd\u5bc6\u7801\u5b89\u5168\r\nstring sha1 = Sha256Hex(rawPwd);            // \u7b2c\u4e00\u6b21SHA-256\r\nstring sha2 = Sha256Hex(sha1 + tsStr);      // \u7b2c\u4e8c\u6b21SHA-256 + \u65f6\u95f4\u6233\n"})}),"\n",(0,l.jsx)(e.h3,{id:"2-\u9632\u91cd\u590d\u70b9\u51fb",children:"2. \u9632\u91cd\u590d\u70b9\u51fb"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AccountAuthController.cs - \u5b9e\u9645\u5b9e\u73b0"',children:"private void OnClickLogin()\r\n{\r\n    // \u7981\u7528\u6309\u94ae\u9632\u6b62\u91cd\u590d\u70b9\u51fb\r\n    loginBtn.SetEnabled(false);\r\n    \r\n    api.PasswordLogin(account, password,\r\n        ok: _ => loginBtn.SetEnabled(true),\r\n        fail: _ => loginBtn.SetEnabled(true)\r\n    );\r\n}\n"})}),"\n",(0,l.jsx)(e.h3,{id:"3-\u65f6\u95f4\u6233\u9632\u91cd\u653e",children:"3. \u65f6\u95f4\u6233\u9632\u91cd\u653e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AuthAPI.cs - \u5b9e\u9645\u5b9e\u73b0"',children:'// \u6bcf\u6b21\u8bf7\u6c42\u90fd\u5e26\u65f6\u95f4\u6233\r\nlong ts = DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();\r\nstring tsStr = ts.ToString();\r\n\r\nstring body = $@"{{\r\n    ""username"": ""{account}"",\r\n    ""password"": ""{sha2}"",\r\n    ""timestamp"": ""{tsStr}""  // \u65f6\u95f4\u6233\u9632\u6b62\u91cd\u653e\u653b\u51fb\r\n}}";\n'})}),"\n",(0,l.jsx)(e.h2,{id:"\u7528\u6237\u4f53\u9a8c\u4f18\u5316",children:"\u7528\u6237\u4f53\u9a8c\u4f18\u5316"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u6e05\u7a7a\u8f93\u5165",children:"1. \u6e05\u7a7a\u8f93\u5165"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="AccountAuthController.cs - \u5b9e\u9645\u5b9e\u73b0"',children:'// \u767b\u5f55\u6210\u529f\u540e\u6e05\u7a7a\u6240\u6709\u8f93\u5165\r\nprivate void ClearAllInputs()\r\n{\r\n    loginAccField?.SetValue("");\r\n    loginPwdField?.SetValue("");\r\n    regAccField?.SetValue("");\r\n    regPwdField1?.SetValue("");\r\n    regPwdField2?.SetValue("");\r\n    // ... \u5176\u4ed6\u8f93\u5165\u6846\r\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"2-\u9632\u91cd\u590d\u70b9\u51fb-1",children:"2. \u9632\u91cd\u590d\u70b9\u51fb"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="\u5b9e\u9645\u5b9e\u73b0"',children:"private void OnClickLogin()\r\n{\r\n    // \u7981\u7528\u6309\u94ae\u9632\u6b62\u91cd\u590d\u70b9\u51fb\r\n    loginBtn.SetEnabled(false);\r\n    \r\n    // \u8bf7\u6c42\u5b8c\u6210\u540e\u6062\u590d\r\n    api.PasswordLogin(account, password,\r\n        ok: _ => loginBtn.SetEnabled(true),\r\n        fail: _ => loginBtn.SetEnabled(true)\r\n    );\r\n}\n"})}),"\n",(0,l.jsx)(e.h3,{id:"3-loading\u53cd\u9988",children:"3. Loading\u53cd\u9988"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-csharp",metastring:'title="LoadingPanelManager.cs - \u5b9e\u9645\u4ee3\u7801"',children:"// \u5168\u5c4fLoading\uff08\u53ea\u6709\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff09\r\nLoadingPanelManager.Instance.Show();\r\nLoadingPanelManager.Instance.Hide();\r\n\r\n// \u5c40\u90e8Loading\uff08SpinController\uff09\r\nSpinController.Instance.Show();\r\nSpinController.Instance.Hide();\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u6d4b\u8bd5\u8981\u70b9",children:"\u6d4b\u8bd5\u8981\u70b9"}),"\n",(0,l.jsx)(e.h3,{id:"\u529f\u80fd\u6d4b\u8bd5\u6e05\u5355",children:"\u529f\u80fd\u6d4b\u8bd5\u6e05\u5355"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6b63\u5e38\u767b\u5f55\u6d41\u7a0b"}),"\n",(0,l.jsx)(e.li,{children:"\u9519\u8bef\u5bc6\u7801\u5904\u7406"}),"\n",(0,l.jsx)(e.li,{children:"\u7f51\u7edc\u5f02\u5e38\u5904\u7406"}),"\n",(0,l.jsx)(e.li,{children:"\u5e76\u53d1\u767b\u5f55\u6d4b\u8bd5"}),"\n",(0,l.jsx)(e.li,{children:"\u5f31\u7f51\u73af\u5883\u6d4b\u8bd5"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u8fb9\u754c\u6761\u4ef6",children:"\u8fb9\u754c\u6761\u4ef6"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u8d26\u53f7\u957f\u5ea6\u8fb9\u754c\uff083-20\u5b57\u7b26\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u5bc6\u7801\u957f\u5ea6\u8fb9\u754c\uff086-20\u5b57\u7b26\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u7279\u6b8a\u5b57\u7b26\u8fc7\u6ee4"}),"\n",(0,l.jsx)(e.li,{children:"\u7a7a\u8f93\u5165\u5904\u7406"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,l.jsx)(e.h3,{id:"q-\u4e3a\u4ec0\u4e48\u4f7f\u7528\u53cc\u91cdsha256",children:"Q: \u4e3a\u4ec0\u4e48\u4f7f\u7528\u53cc\u91cdSHA256\uff1f"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"A:"})," \u7b2c\u4e00\u6b21SHA256\u786e\u4fdd\u5bc6\u7801\u4e0d\u53ef\u9006\uff0c\u7b2c\u4e8c\u6b21\u52a0\u5165\u65f6\u95f4\u6233\u9632\u6b62\u91cd\u653e\u653b\u51fb\u3002\u5373\u4f7f\u7f51\u7edc\u5305\u88ab\u622a\u83b7\uff0c\u653b\u51fb\u8005\u4e5f\u65e0\u6cd5\u91cd\u590d\u4f7f\u7528\u3002"]}),"\n",(0,l.jsx)(e.h3,{id:"q-\u5982\u4f55\u5904\u7406\u5bc6\u7801\u627e\u56de",children:"Q: \u5982\u4f55\u5904\u7406\u5bc6\u7801\u627e\u56de\uff1f"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"A:"})," \u901a\u8fc7\u90ae\u7bb1\u9a8c\u8bc1\u7801\u91cd\u7f6e\u5bc6\u7801\uff0c\u8be6\u89c1",(0,l.jsx)(e.a,{href:"/ROL_Docs/docs/%E7%99%BB%E5%BD%95/email-verification",children:"\u90ae\u7bb1\u9a8c\u8bc1\u7cfb\u7edf"}),"\u3002"]}),"\n",(0,l.jsx)(e.h3,{id:"q-\u767b\u5f55\u5931\u8d25\u600e\u4e48\u529e",children:"Q: \u767b\u5f55\u5931\u8d25\u600e\u4e48\u529e\uff1f"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"A:"})," \u68c0\u67e5\u8d26\u53f7\u5bc6\u7801\u662f\u5426\u6b63\u786e\uff0c\u786e\u8ba4\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\u3002\u7cfb\u7edf\u4f1a\u901a\u8fc7PopupManager\u663e\u793a\u5177\u4f53\u9519\u8bef\u4fe1\u606f\u3002"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(o,{...n})}):o(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>s,x:()=>a});var i=r(6540);const l={},t=i.createContext(l);function s(n){const e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:s(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);